/Library/Java/JavaVirtualMachines/jdk-17.0.5.jdk/Contents/Home/bin/java -agentlib:jdwp=transport=dt_socket,address=127.0.0.1:61124,suspend=y,server=n -XX:TieredStopAtLevel=1 -Dspring.output.ansi.enabled=always -Dcom.sun.management.jmxremote -Dspring.jmx.enabled=true -Dspring.liveBeansView.mbeanDomain -Dspring.application.admin.enabled=true -Dmanagement.endpoints.jmx.exposure.include=* -javaagent:/Users/kirillselivanov/Library/Caches/JetBrains/IntelliJIdea2023.2/captureAgent/debugger-agent.jar -Dfile.encoding=UTF-8 -classpath /Users/kirillselivanov/IdeaProject/transactional/build/classes/java/main:/Users/kirillselivanov/IdeaProject/transactional/build/resources/main:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.projectlombok/lombok/1.18.28/a2ff5da8bcd8b1b26f36b806ced63213362c6dcc/lombok-1.18.28.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.springframework.boot/spring-boot-starter-data-jpa/3.1.3/f0a12154dd3ecee15f6b0ad9cc8025cb600cbbfc/spring-boot-starter-data-jpa-3.1.3.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.springframework.cloud/spring-cloud-starter-stream-kafka/4.0.4/156d62f7add4546697db9fc9d7e11dd84bd06d53/spring-cloud-starter-stream-kafka-4.0.4.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.springframework.boot/spring-boot-starter-aop/3.1.3/fd9c2fbba8e627f6d76c30915fab059396c91243/spring-boot-starter-aop-3.1.3.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.springframework.boot/spring-boot-starter-jdbc/3.1.3/149a8252a24b88b92b64918781222e225297f956/spring-boot-starter-jdbc-3.1.3.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.hibernate.orm/hibernate-core/6.2.7.Final/41ef07e4272936741bd47cb638d4f10d06bdb86/hibernate-core-6.2.7.Final.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.springframework.data/spring-data-jpa/3.1.3/b521cf73f77556938bb6a8a7330a6f948152381b/spring-data-jpa-3.1.3.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.springframework/spring-aspects/6.0.11/7b6fcc5d4f06c36c332b7a122dca863163a127d4/spring-aspects-6.0.11.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.springframework.cloud/spring-cloud-stream-binder-kafka/4.0.4/a511115f465d65546cb390785d204073897057a/spring-cloud-stream-binder-kafka-4.0.4.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.springframework.boot/spring-boot-starter/3.1.3/c59f038f005cf8fb3338b7b9e50e9a65bac1ebca/spring-boot-starter-3.1.3.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.springframework/spring-aop/6.0.11/15b85c825558fadb85e3c77779d7225ce7e4a7bc/spring-aop-6.0.11.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.aspectj/aspectjweaver/1.9.20/da562407e43f74c0f8f5f5df4065d85ec1736d01/aspectjweaver-1.9.20.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/com.zaxxer/HikariCP/5.0.1/a74c7f0a37046846e88d54f7cb6ea6d565c65f9c/HikariCP-5.0.1.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.springframework/spring-jdbc/6.0.11/dc495b5cb8052f044fd29aa68bb2231b1895b8f4/spring-jdbc-6.0.11.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/jakarta.persistence/jakarta.persistence-api/3.1.0/66901fa1c373c6aff65c13791cc11da72060a8d6/jakarta.persistence-api-3.1.0.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/jakarta.transaction/jakarta.transaction-api/2.0.1/51a520e3fae406abb84e2e1148e6746ce3f80a1a/jakarta.transaction-api-2.0.1.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.springframework/spring-context/6.0.11/a7b10f3d3c1492bfc4e6d7c966cd2e21f4d441f5/spring-context-6.0.11.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.springframework/spring-orm/6.0.11/dde0c5f956052c8c3865e95202dd35b7437b2c6f/spring-orm-6.0.11.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.springframework.data/spring-data-commons/3.1.3/afd3a74a2cd476022c6cdfd6679120f0e69e0f50/spring-data-commons-3.1.3.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.springframework/spring-tx/6.0.11/59cd03d2ba6968ade8c192b4d6488efb48ec36f/spring-tx-6.0.11.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.springframework/spring-beans/6.0.11/8513efc6e94b407b5cd85f69eeec511f1ef34164/spring-beans-6.0.11.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.springframework/spring-core/6.0.11/87834b5cf95c6fa28f5bdf8a85e0daf0bff918a8/spring-core-6.0.11.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.antlr/antlr4-runtime/4.10.1/10839f875928f59c622d675091d51a43ea0dc5f7/antlr4-runtime-4.10.1.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/jakarta.annotation/jakarta.annotation-api/2.1.1/48b9bda22b091b1f48b13af03fe36db3be6e1ae3/jakarta.annotation-api-2.1.1.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.slf4j/slf4j-api/2.0.7/41eb7184ea9d556f23e18b5cb99cad1f8581fc00/slf4j-api-2.0.7.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.springframework.cloud/spring-cloud-stream-binder-kafka-core/4.0.4/3dc2c2153438fa8c213355e1b36d15eacc4393c3/spring-cloud-stream-binder-kafka-core-4.0.4.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.springframework.cloud/spring-cloud-stream/4.0.4/9a38c9a4422df9579c80efae8374e0af3fecf2ea/spring-cloud-stream-4.0.4.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.springframework.kafka/spring-kafka/3.0.10/37cc556f72ea375512070eb210369bbfe2ad69ec/spring-kafka-3.0.10.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.springframework.boot/spring-boot-autoconfigure/3.1.3/d7d4e0cdf5a42158a5460feb67d0c56aba2ef8b2/spring-boot-autoconfigure-3.1.3.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.springframework.boot/spring-boot/3.1.3/7161dbfbbdde423513c89deae00da8068319a26a/spring-boot-3.1.3.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.springframework.boot/spring-boot-starter-logging/3.1.3/8a4402a80f01fb8193907b1ea6c9f4a71df6589e/spring-boot-starter-logging-3.1.3.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.yaml/snakeyaml/1.33/2cd0a87ff7df953f810c344bdf2fe3340b954c69/snakeyaml-1.33.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.springframework/spring-expression/6.0.11/1d0940120a275719c3988c592068f4acf807fe59/spring-expression-6.0.11.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.springframework/spring-jcl/6.0.11/c9b16cdb6d4874ba4118fcdd4b0335f6278b378/spring-jcl-6.0.11.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.springframework.integration/spring-integration-kafka/6.1.2/2d65fc252eb76a7bcb29aede109f62e097b37c0/spring-integration-kafka-6.1.2.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.springframework.boot/spring-boot-starter-validation/3.1.3/fdf58f7fb49600f02dec49549bc629d2ae9c6de0/spring-boot-starter-validation-3.1.3.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.springframework.cloud/spring-cloud-function-context/4.0.5/444f0001c3d982c8cf49f810ea7443d70f32cc90/spring-cloud-function-context-4.0.5.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.springframework.integration/spring-integration-jmx/6.1.2/71d22595bdb6a752d8b42c74539b8b96e20b6348/spring-integration-jmx-6.1.2.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.springframework.integration/spring-integration-core/6.1.2/3bc9a606d195d5818b6df64925d473ec3473151a/spring-integration-core-6.1.2.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.springframework/spring-messaging/6.0.11/18cb0c2e15e49212119bd48b2303e2c0c081c58d/spring-messaging-6.0.11.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.springframework.retry/spring-retry/2.0.2/bd0d8859447e4311c0e0e4bfb5d571d57d9011cf/spring-retry-2.0.2.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.jetbrains.kotlin/kotlin-stdlib-jdk8/1.8.22/b25c86d47d6b962b9cf0f8c3f320c8a10eea3dd1/kotlin-stdlib-jdk8-1.8.22.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.apache.kafka/kafka-clients/3.4.1/a2f55251deb3d31a21903a0cfbd4d1fa6b7463ca/kafka-clients-3.4.1.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/io.micrometer/micrometer-observation/1.11.3/aaea9efe8f00c184b12f729a2f37e18ca4f33b8d/micrometer-observation-1.11.3.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/ch.qos.logback/logback-classic/1.4.11/54450c0c783e896a1a6d88c043bd2f1daba1c382/logback-classic-1.4.11.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.apache.logging.log4j/log4j-to-slf4j/2.20.0/d37f81f8978e2672bc32c82712ab4b3f66624adc/log4j-to-slf4j-2.20.0.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.slf4j/jul-to-slf4j/2.0.7/a48f44aeaa8a5ddc347007298a28173ac1fbbd8b/jul-to-slf4j-2.0.7.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.apache.tomcat.embed/tomcat-embed-el/10.1.12/2a8cfb1053b6f7c445d78186ac32c73eb773973c/tomcat-embed-el-10.1.12.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.hibernate.validator/hibernate-validator/8.0.1.Final/e49e116b3d3928060599b176b3538bb848718e95/hibernate-validator-8.0.1.Final.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.springframework.cloud/spring-cloud-function-core/4.0.5/36b6ae5f233aa104fe3f063c01b779b1db0c16e9/spring-cloud-function-core-4.0.5.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/net.jodah/typetools/0.6.2/d1e38fe8e668f228b0761d80a6c80c151ab6044a/typetools-0.6.2.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/com.fasterxml.jackson.core/jackson-databind/2.15.2/9353b021f10c307c00328f52090de2bdb4b6ff9c/jackson-databind-2.15.2.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/io.projectreactor/reactor-core/3.5.9/1e127cb91adf7535eb90b284159612f8a2d06e2f/reactor-core-3.5.9.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.jetbrains.kotlin/kotlin-stdlib-jdk7/1.8.22/4dabb8248310d833bb6a8b516024a91fd3d275c/kotlin-stdlib-jdk7-1.8.22.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.jetbrains.kotlin/kotlin-stdlib/1.8.22/636bf8b320e7627482771bbac9ed7246773c02bd/kotlin-stdlib-1.8.22.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/io.micrometer/micrometer-commons/1.11.3/3422d6b1e5ce99cc3ad9ae83dbc83409e2f07603/micrometer-commons-1.11.3.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/ch.qos.logback/logback-core/1.4.11/2f9f280219a9922a74200eaf7138c4c17fb87c0f/logback-core-1.4.11.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.apache.logging.log4j/log4j-api/2.20.0/1fe6082e660daf07c689a89c94dc0f49c26b44bb/log4j-api-2.20.0.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/jakarta.validation/jakarta.validation-api/3.0.2/92b6631659ba35ca09e44874d3eb936edfeee532/jakarta.validation-api-3.0.2.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.jboss.logging/jboss-logging/3.5.3.Final/c88fc1d8a96d4c3491f55d4317458ccad53ca663/jboss-logging-3.5.3.Final.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/com.fasterxml/classmate/1.5.1/3fe0bed568c62df5e89f4f174c101eab25345b6c/classmate-1.5.1.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/com.fasterxml.jackson.core/jackson-annotations/2.15.2/4724a65ac8e8d156a24898d50fd5dbd3642870b8/jackson-annotations-2.15.2.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/com.fasterxml.jackson.core/jackson-core/2.15.2/a6fe1836469a69b3ff66037c324d75fc66ef137c/jackson-core-2.15.2.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.reactivestreams/reactive-streams/1.0.4/3864a1320d97d7b045f729a326e1e077661f31b7/reactive-streams-1.0.4.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.jetbrains.kotlin/kotlin-stdlib-common/1.8.22/1a8e3601703ae14bb58757ea6b2d8e8e5935a586/kotlin-stdlib-common-1.8.22.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.jetbrains/annotations/13.0/919f0dfe192fb4e063e7dacadee7f8bb9a2672a9/annotations-13.0.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.postgresql/postgresql/42.6.0/7614cfce466145b84972781ab0079b8dea49e363/postgresql-42.6.0.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.checkerframework/checker-qual/3.31.0/eeefd4af42e2f4221d145c1791582f91868f99ab/checker-qual-3.31.0.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.hibernate.common/hibernate-commons-annotations/6.0.6.Final/77a5f94b56d49508e0ee334751db5b78e5ccd50c/hibernate-commons-annotations-6.0.6.Final.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/io.smallrye/jandex/3.0.5/c548a4871b552292dbdd65409d3fda145c8925c1/jandex-3.0.5.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/net.bytebuddy/byte-buddy/1.14.6/316c1b1f3208a9d716c4419ed2080443235f7d1/byte-buddy-1.14.6.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.glassfish.jaxb/jaxb-runtime/4.0.3/93af25be25b2c92c83e0ce61cb8b3ed23568f316/jaxb-runtime-4.0.3.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/jakarta.xml.bind/jakarta.xml.bind-api/4.0.0/bbb399208d288b15ec101fa4fcfc4bd77cedc97a/jakarta.xml.bind-api-4.0.0.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/jakarta.inject/jakarta.inject-api/2.0.1/4c28afe1991a941d7702fe1362c365f0a8641d1e/jakarta.inject-api-2.0.1.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.glassfish.jaxb/jaxb-core/4.0.3/e9093b4a82069a1d78ee9a3233ca387bca88861f/jaxb-core-4.0.3.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/jakarta.activation/jakarta.activation-api/2.1.2/640c0d5aff45dbff1e1a1bc09673ff3a02b1ba12/jakarta.activation-api-2.1.2.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/com.google.code.findbugs/jsr305/3.0.2/25ea2e8b0c338a877313bd4672d3fe056ea78f0d/jsr305-3.0.2.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.eclipse.angus/angus-activation/2.0.1/eaafaf4eb71b400e4136fc3a286f50e34a68ecb7/angus-activation-2.0.1.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.glassfish.jaxb/txw2/4.0.3/47b8fe31c6d1a3382203af919400527389e01e9c/txw2-4.0.3.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/com.sun.istack/istack-commons-runtime/4.1.2/18ec117c85f3ba0ac65409136afa8e42bc74e739/istack-commons-runtime-4.1.2.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/com.github.luben/zstd-jni/1.5.2-1/fad786abc1d1b81570e8d9a2fc8a1ef479bc27b6/zstd-jni-1.5.2-1.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.lz4/lz4-java/1.8.0/4b986a99445e49ea5fbf5d149c4b63f6ed6c6780/lz4-java-1.8.0.jar:/Users/kirillselivanov/.gradle/caches/modules-2/files-2.1/org.xerial.snappy/snappy-java/1.1.8.4/66f0d56454509f6e36175f2331572e250e04a6cc/snappy-java-1.1.8.4.jar:/Applications/IntelliJ IDEA.app/Contents/lib/idea_rt.jar ru.test.transactional.TransactionalApplication
Connected to the target VM, address: '127.0.0.1:61124', transport: 'socket'

  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/
 :: Spring Boot ::                (v3.1.3)

2024-04-03T17:35:32.122+03:00  INFO 45784 --- [           main] r.t.t.TransactionalApplication           : Starting TransactionalApplication using Java 17.0.5 with PID 45784 (/Users/kirillselivanov/IdeaProject/transactional/build/classes/java/main started by kirillselivanov in /Users/kirillselivanov/IdeaProject/transactional)
2024-04-03T17:35:32.123+03:00  INFO 45784 --- [           main] r.t.t.TransactionalApplication           : No active profile set, falling back to 1 default profile: "default"
2024-04-03T17:35:32.409+03:00  INFO 45784 --- [           main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2024-04-03T17:35:32.478+03:00  INFO 45784 --- [           main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 65 ms. Found 1 JPA repository interfaces.
2024-04-03T17:35:32.532+03:00  INFO 45784 --- [           main] faultConfiguringBeanFactoryPostProcessor : No bean named 'errorChannel' has been explicitly defined. Therefore, a default PublishSubscribeChannel will be created.
2024-04-03T17:35:32.536+03:00  INFO 45784 --- [           main] faultConfiguringBeanFactoryPostProcessor : No bean named 'integrationHeaderChannelRegistry' has been explicitly defined. Therefore, a default DefaultHeaderChannelRegistry will be created.
2024-04-03T17:35:32.658+03:00  INFO 45784 --- [           main] trationDelegate$BeanPostProcessorChecker : Bean 'org.springframework.boot.autoconfigure.integration.IntegrationAutoConfiguration$IntegrationJmxConfiguration' of type [org.springframework.boot.autoconfigure.integration.IntegrationAutoConfiguration$IntegrationJmxConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2024-04-03T17:35:32.662+03:00  INFO 45784 --- [           main] trationDelegate$BeanPostProcessorChecker : Bean 'org.springframework.cloud.stream.binder.kafka.config.ExtendedBindingHandlerMappingsProviderConfiguration' of type [org.springframework.cloud.stream.binder.kafka.config.ExtendedBindingHandlerMappingsProviderConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2024-04-03T17:35:32.662+03:00  INFO 45784 --- [           main] trationDelegate$BeanPostProcessorChecker : Bean 'kafkaExtendedPropertiesDefaultMappingsProvider' of type [org.springframework.cloud.stream.binder.kafka.config.ExtendedBindingHandlerMappingsProviderConfiguration$$Lambda$567/0x0000000800f964a8] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2024-04-03T17:35:32.663+03:00  INFO 45784 --- [           main] trationDelegate$BeanPostProcessorChecker : Bean 'BindingHandlerAdvise' of type [org.springframework.cloud.stream.config.BindingHandlerAdvise] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2024-04-03T17:35:32.666+03:00  INFO 45784 --- [           main] trationDelegate$BeanPostProcessorChecker : Bean 'spelConverter' of type [org.springframework.cloud.stream.config.SpelExpressionConverterConfiguration$SpelConverter] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2024-04-03T17:35:32.670+03:00  INFO 45784 --- [           main] trationDelegate$BeanPostProcessorChecker : Bean 'spring.jmx-org.springframework.boot.autoconfigure.jmx.JmxProperties' of type [org.springframework.boot.autoconfigure.jmx.JmxProperties] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2024-04-03T17:35:32.673+03:00  INFO 45784 --- [           main] trationDelegate$BeanPostProcessorChecker : Bean 'org.springframework.boot.autoconfigure.jmx.JmxAutoConfiguration' of type [org.springframework.boot.autoconfigure.jmx.JmxAutoConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2024-04-03T17:35:32.675+03:00  INFO 45784 --- [           main] trationDelegate$BeanPostProcessorChecker : Bean 'mbeanServer' of type [com.sun.jmx.mbeanserver.JmxMBeanServer] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2024-04-03T17:35:32.729+03:00 DEBUG 45784 --- [           main] j.LocalContainerEntityManagerFactoryBean : Building JPA container EntityManagerFactory for persistence unit 'default'
2024-04-03T17:35:32.736+03:00  INFO 45784 --- [           main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2024-04-03T17:35:32.765+03:00  INFO 45784 --- [           main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.2.7.Final
2024-04-03T17:35:32.766+03:00  INFO 45784 --- [           main] org.hibernate.cfg.Environment            : HHH000406: Using bytecode reflection optimizer
2024-04-03T17:35:32.836+03:00  INFO 45784 --- [           main] o.h.b.i.BytecodeProviderInitiator        : HHH000021: Bytecode provider name : bytebuddy
2024-04-03T17:35:32.903+03:00  INFO 45784 --- [           main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2024-04-03T17:35:32.912+03:00  INFO 45784 --- [           main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2024-04-03T17:35:33.035+03:00  INFO 45784 --- [           main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@72ecbcb3
2024-04-03T17:35:33.036+03:00  INFO 45784 --- [           main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2024-04-03T17:35:33.228+03:00  INFO 45784 --- [           main] o.h.b.i.BytecodeProviderInitiator        : HHH000021: Bytecode provider name : bytebuddy
2024-04-03T17:35:33.513+03:00  INFO 45784 --- [           main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2024-04-03T17:35:33.555+03:00  INFO 45784 --- [           main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2024-04-03T17:35:33.602+03:00 DEBUG 45784 --- [           main] tor$SharedEntityManagerInvocationHandler : Creating new EntityManager for shared EntityManager invocation
2024-04-03T17:35:33.620+03:00 DEBUG 45784 --- [           main] tor$SharedEntityManagerInvocationHandler : Creating new EntityManager for shared EntityManager invocation
2024-04-03T17:35:33.641+03:00 DEBUG 45784 --- [           main] tor$SharedEntityManagerInvocationHandler : Creating new EntityManager for shared EntityManager invocation
2024-04-03T17:35:33.703+03:00 TRACE 45784 --- [           main] t.a.AnnotationTransactionAttributeSource : Adding transactional method 'ru.test.transactional.service.PersonService.save' with attribute: PROPAGATION_REQUIRED,ISOLATION_DEFAULT; 'chainedKafkaTransactionManager'
2024-04-03T17:35:33.710+03:00  INFO 45784 --- [           main] o.s.c.s.binder.DefaultBinderFactory      : Creating binder: kafka
2024-04-03T17:35:33.710+03:00  INFO 45784 --- [           main] o.s.c.s.binder.DefaultBinderFactory      : Constructing binder child context for kafka
2024-04-03T17:35:33.791+03:00  INFO 45784 --- [           main] o.s.c.s.binder.DefaultBinderFactory      : Caching the binder: kafka
2024-04-03T17:35:33.945+03:00  INFO 45784 --- [           main] o.s.i.monitor.IntegrationMBeanExporter   : Registering MessageChannel errorChannel
2024-04-03T17:35:33.949+03:00  INFO 45784 --- [           main] o.s.i.monitor.IntegrationMBeanExporter   : Registering MessageChannel nullChannel
2024-04-03T17:35:33.953+03:00  INFO 45784 --- [           main] o.s.i.monitor.IntegrationMBeanExporter   : Registering MessageHandler _org.springframework.integration.errorLogger
2024-04-03T17:35:33.959+03:00  INFO 45784 --- [           main] o.s.i.endpoint.EventDrivenConsumer       : Adding {logging-channel-adapter:_org.springframework.integration.errorLogger} as a subscriber to the 'errorChannel' channel
2024-04-03T17:35:33.959+03:00  INFO 45784 --- [           main] o.s.i.channel.PublishSubscribeChannel    : Channel 'transactional.errorChannel' has 1 subscriber(s).
2024-04-03T17:35:33.959+03:00  INFO 45784 --- [           main] o.s.i.endpoint.EventDrivenConsumer       : started bean '_org.springframework.integration.errorLogger'
2024-04-03T17:35:33.964+03:00  INFO 45784 --- [           main] r.t.t.TransactionalApplication           : Started TransactionalApplication in 1.991 seconds (process running for 2.331)
2024-04-03T17:35:33.967+03:00 DEBUG 45784 --- [           main] o.s.k.t.KafkaTransactionManager          : Creating new transaction with name [ru.test.transactional.service.PersonService.save]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT; 'chainedKafkaTransactionManager'

2024-04-03T17:35:33.986+03:00  INFO 45784 --- [           main] o.a.k.clients.producer.KafkaProducer     : [Producer clientId=producer-tx-binder-0, transactionalId=tx-binder-0] Instantiated a transactional producer.
2024-04-03T17:35:34.008+03:00  INFO 45784 --- [           main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.4.1
2024-04-03T17:35:34.008+03:00  INFO 45784 --- [           main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: 8a516edc2755df89
2024-04-03T17:35:34.008+03:00  INFO 45784 --- [           main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1712154934007
2024-04-03T17:35:34.010+03:00  INFO 45784 --- [           main] o.a.k.c.p.internals.TransactionManager   : [Producer clientId=producer-tx-binder-0, transactionalId=tx-binder-0] Invoking InitProducerId for the first time in order to acquire a producer ID
2024-04-03T17:35:34.151+03:00  INFO 45784 --- [cer-tx-binder-0] org.apache.kafka.clients.Metadata        : [Producer clientId=producer-tx-binder-0, transactionalId=tx-binder-0] Cluster ID: AWxaogOuQTKyQCesJXostg
2024-04-03T17:35:34.154+03:00  INFO 45784 --- [cer-tx-binder-0] o.a.k.c.p.internals.TransactionManager   : [Producer clientId=producer-tx-binder-0, transactionalId=tx-binder-0] Discovered transaction coordinator localhost:9092 (id: 1 rack: null)
2024-04-03T17:35:34.283+03:00  INFO 45784 --- [cer-tx-binder-0] o.a.k.c.p.internals.TransactionManager   : [Producer clientId=producer-tx-binder-0, transactionalId=tx-binder-0] ProducerId set to 1 with epoch 6
2024-04-03T17:35:34.284+03:00 DEBUG 45784 --- [           main] o.s.k.core.DefaultKafkaProducerFactory   : Created new Producer: CloseSafeProducer [delegate=org.apache.kafka.clients.producer.KafkaProducer@3ef7fb04]
2024-04-03T17:35:34.284+03:00 DEBUG 45784 --- [           main] o.s.k.core.DefaultKafkaProducerFactory   : CloseSafeProducer [delegate=org.apache.kafka.clients.producer.KafkaProducer@3ef7fb04] beginTransaction()
2024-04-03T17:35:34.285+03:00 DEBUG 45784 --- [           main] o.s.k.t.KafkaTransactionManager          : Created Kafka transaction on producer [CloseSafeProducer [delegate=org.apache.kafka.clients.producer.KafkaProducer@3ef7fb04]]
2024-04-03T17:35:34.285+03:00 DEBUG 45784 --- [           main] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [ru.test.transactional.service.PersonService.save]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT; 'chainedKafkaTransactionManager'
2024-04-03T17:35:34.285+03:00 DEBUG 45784 --- [           main] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(1964740634<open>)] for JPA transaction
2024-04-03T17:35:34.288+03:00 DEBUG 45784 --- [           main] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@70b0dc92]
2024-04-03T17:35:34.289+03:00 TRACE 45784 --- [           main] o.s.t.i.TransactionInterceptor           : Getting transaction for [ru.test.transactional.service.PersonService.save]
2024-04-03T17:35:34.431+03:00 TRACE 45784 --- [           main] o.s.t.i.TransactionInterceptor           : No need to create transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.toString]: This method is not transactional.
2024-04-03T17:35:34.451+03:00 TRACE 45784 --- [           main] o.s.t.i.TransactionInterceptor           : No need to create transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.toString]: This method is not transactional.
2024-04-03T17:36:03.876+03:00 DEBUG 45784 --- [           main] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(1964740634<open>)] for JPA transaction
2024-04-03T17:36:03.877+03:00 DEBUG 45784 --- [           main] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-04-03T17:36:03.878+03:00 TRACE 45784 --- [           main] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.save]
Hibernate:
    insert
    into
        person
        (name)
    values
        (?)
2024-04-03T17:36:04.032+03:00 TRACE 45784 --- [           main] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.save]
2024-04-03T17:36:04.085+03:00 TRACE 45784 --- [           main] o.s.t.i.TransactionInterceptor           : No need to create transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.toString]: This method is not transactional.
2024-04-03T17:36:04.106+03:00 TRACE 45784 --- [           main] o.s.t.i.TransactionInterceptor           : No need to create transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.toString]: This method is not transactional.
2024-04-03T17:36:21.283+03:00  INFO 45784 --- [           main] o.s.c.s.b.k.p.KafkaTopicProvisioner      : Using kafka topic for outbound: topic
2024-04-03T17:36:21.290+03:00  INFO 45784 --- [           main] o.a.k.clients.admin.AdminClientConfig    : AdminClientConfig values:

2024-04-03T17:36:21.367+03:00  INFO 45784 --- [           main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.4.1
2024-04-03T17:36:21.367+03:00  INFO 45784 --- [           main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: 8a516edc2755df89
2024-04-03T17:36:21.368+03:00  INFO 45784 --- [           main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1712154981366
2024-04-03T17:36:21.399+03:00  INFO 45784 --- [| adminclient-1] o.a.kafka.common.utils.AppInfoParser     : App info kafka.admin.client for adminclient-1 unregistered
2024-04-03T17:36:21.401+03:00  INFO 45784 --- [| adminclient-1] o.apache.kafka.common.metrics.Metrics    : Metrics scheduler closed
2024-04-03T17:36:21.401+03:00  INFO 45784 --- [| adminclient-1] o.apache.kafka.common.metrics.Metrics    : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2024-04-03T17:36:21.401+03:00  INFO 45784 --- [| adminclient-1] o.apache.kafka.common.metrics.Metrics    : Metrics reporters closed

2024-04-03T17:36:21.419+03:00  INFO 45784 --- [           main] o.a.k.clients.producer.KafkaProducer     : [Producer clientId=producer-tx-binder-1, transactionalId=tx-binder-1] Instantiated a transactional producer.
2024-04-03T17:36:21.455+03:00  INFO 45784 --- [           main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.4.1
2024-04-03T17:36:21.456+03:00  INFO 45784 --- [           main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: 8a516edc2755df89
2024-04-03T17:36:21.456+03:00  INFO 45784 --- [           main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1712154981455
2024-04-03T17:36:21.458+03:00  INFO 45784 --- [           main] o.a.k.c.p.internals.TransactionManager   : [Producer clientId=producer-tx-binder-1, transactionalId=tx-binder-1] Invoking InitProducerId for the first time in order to acquire a producer ID
2024-04-03T17:36:21.460+03:00  INFO 45784 --- [cer-tx-binder-1] org.apache.kafka.clients.Metadata        : [Producer clientId=producer-tx-binder-1, transactionalId=tx-binder-1] Cluster ID: AWxaogOuQTKyQCesJXostg
2024-04-03T17:36:21.462+03:00  INFO 45784 --- [cer-tx-binder-1] o.a.k.c.p.internals.TransactionManager   : [Producer clientId=producer-tx-binder-1, transactionalId=tx-binder-1] Discovered transaction coordinator localhost:9092 (id: 1 rack: null)
2024-04-03T17:36:21.578+03:00  INFO 45784 --- [cer-tx-binder-1] o.a.k.c.p.internals.TransactionManager   : [Producer clientId=producer-tx-binder-1, transactionalId=tx-binder-1] ProducerId set to 2 with epoch 6
2024-04-03T17:36:21.578+03:00 DEBUG 45784 --- [           main] o.s.k.core.DefaultKafkaProducerFactory   : Created new Producer: CloseSafeProducer [delegate=org.apache.kafka.clients.producer.KafkaProducer@3615f8d9]
2024-04-03T17:36:21.585+03:00  INFO 45784 --- [cer-tx-binder-1] org.apache.kafka.clients.Metadata        : [Producer clientId=producer-tx-binder-1, transactionalId=tx-binder-1] Resetting the last seen epoch of partition topic-0 to 0 since the associated topicId changed from null to 5QH-OGY_TDGkpzRVEMx1FA
2024-04-03T17:36:21.591+03:00 TRACE 45784 --- [           main] o.s.k.core.DefaultKafkaProducerFactory   : CloseSafeProducer [delegate=org.apache.kafka.clients.producer.KafkaProducer@3615f8d9] close(null)
2024-04-03T17:36:21.618+03:00  INFO 45784 --- [           main] o.s.c.s.m.DirectWithAttributesChannel    : Channel 'unknown.channel.name' has 1 subscriber(s).
2024-04-03T17:36:21.730+03:00 TRACE 45784 --- [           main] o.s.kafka.core.KafkaTemplate             : Sending: ProducerRecord(topic=topic, partition=null, headers=RecordHeaders(headers = [RecordHeader(key = contentType, value = [97, 112, 112, 108, 105, 99, 97, 116, 105, 111, 110, 47, 106, 115, 111, 110]), RecordHeader(key = target-protocol, value = [107, 97, 102, 107, 97]), RecordHeader(key = spring_json_header_types, value = [123, 34, 99, 111, 110, 116, 101, 110, 116, 84, 121, 112, 101, 34, 58, 34, 106, 97, 118, 97, 46, 108, 97, 110, 103, 46, 83, 116, 114, 105, 110, 103, 34, 44, 34, 116, 97, 114, 103, 101, 116, 45, 112, 114, 111, 116, 111, 99, 111, 108, 34, 58, 34, 106, 97, 118, 97, 46, 108, 97, 110, 103, 46, 83, 116, 114, 105, 110, 103, 34, 125])], isReadOnly = false), key=null, value=[B@1d1da00b, timestamp=null)
2024-04-03T17:36:21.734+03:00 TRACE 45784 --- [           main] o.s.k.core.DefaultKafkaProducerFactory   : CloseSafeProducer [delegate=org.apache.kafka.clients.producer.KafkaProducer@3ef7fb04] send(ProducerRecord(topic=topic, partition=null, headers=RecordHeaders(headers = [RecordHeader(key = contentType, value = [97, 112, 112, 108, 105, 99, 97, 116, 105, 111, 110, 47, 106, 115, 111, 110]), RecordHeader(key = target-protocol, value = [107, 97, 102, 107, 97]), RecordHeader(key = spring_json_header_types, value = [123, 34, 99, 111, 110, 116, 101, 110, 116, 84, 121, 112, 101, 34, 58, 34, 106, 97, 118, 97, 46, 108, 97, 110, 103, 46, 83, 116, 114, 105, 110, 103, 34, 44, 34, 116, 97, 114, 103, 101, 116, 45, 112, 114, 111, 116, 111, 99, 111, 108, 34, 58, 34, 106, 97, 118, 97, 46, 108, 97, 110, 103, 46, 83, 116, 114, 105, 110, 103, 34, 125])], isReadOnly = false), key=null, value=[B@1d1da00b, timestamp=null))
2024-04-03T17:36:21.740+03:00  INFO 45784 --- [cer-tx-binder-0] org.apache.kafka.clients.Metadata        : [Producer clientId=producer-tx-binder-0, transactionalId=tx-binder-0] Resetting the last seen epoch of partition topic-0 to 0 since the associated topicId changed from null to 5QH-OGY_TDGkpzRVEMx1FA
2024-04-03T17:36:21.785+03:00 TRACE 45784 --- [           main] o.s.kafka.core.KafkaTemplate             : Sent: ProducerRecord(topic=topic, partition=null, headers=RecordHeaders(headers = [RecordHeader(key = contentType, value = [97, 112, 112, 108, 105, 99, 97, 116, 105, 111, 110, 47, 106, 115, 111, 110]), RecordHeader(key = target-protocol, value = [107, 97, 102, 107, 97]), RecordHeader(key = spring_json_header_types, value = [123, 34, 99, 111, 110, 116, 101, 110, 116, 84, 121, 112, 101, 34, 58, 34, 106, 97, 118, 97, 46, 108, 97, 110, 103, 46, 83, 116, 114, 105, 110, 103, 34, 44, 34, 116, 97, 114, 103, 101, 116, 45, 112, 114, 111, 116, 111, 99, 111, 108, 34, 58, 34, 106, 97, 118, 97, 46, 108, 97, 110, 103, 46, 83, 116, 114, 105, 110, 103, 34, 125])], isReadOnly = true), key=null, value=[B@1d1da00b, timestamp=null)
2024-04-03T17:36:21.829+03:00 TRACE 45784 --- [           main] o.s.t.i.TransactionInterceptor           : No need to create transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.toString]: This method is not transactional.
2024-04-03T17:37:18.709+03:00  WARN 45784 --- [l-1 housekeeper] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=1m14s864ms).
2024-04-03T17:37:30.475+03:00 TRACE 45784 --- [           main] o.s.t.i.TransactionInterceptor           : Completing transaction for [ru.test.transactional.service.PersonService.save] after exception: java.lang.RuntimeException
2024-04-03T17:37:37.633+03:00 DEBUG 45784 --- [           main] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction rollback
2024-04-03T17:37:37.635+03:00 DEBUG 45784 --- [           main] o.s.orm.jpa.JpaTransactionManager        : Rolling back JPA transaction on EntityManager [SessionImpl(1964740634<open>)]
2024-04-03T17:37:37.658+03:00 DEBUG 45784 --- [           main] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(1964740634<open>)] after transaction
2024-04-03T17:37:37.659+03:00 DEBUG 45784 --- [           main] o.s.k.t.KafkaTransactionManager          : Initiating transaction rollback
2024-04-03T17:37:37.662+03:00 DEBUG 45784 --- [           main] o.s.k.core.DefaultKafkaProducerFactory   : CloseSafeProducer [delegate=org.apache.kafka.clients.producer.KafkaProducer@3ef7fb04] abortTransaction()
2024-04-03T17:37:37.662+03:00  INFO 45784 --- [           main] o.a.k.clients.producer.KafkaProducer     : [Producer clientId=producer-tx-binder-0, transactionalId=tx-binder-0] Aborting incomplete transaction
2024-04-03T17:37:37.673+03:00 ERROR 45784 --- [cer-tx-binder-0] o.s.k.support.LoggingProducerListener    : Exception thrown when sending a message with key='null' and payload='byte[41]' to topic topic:

org.apache.kafka.common.errors.InvalidProducerEpochException: Producer attempted to produce with an old epoch.

2024-04-03T17:37:37.676+03:00 DEBUG 45784 --- [cer-tx-binder-0] o.s.kafka.core.KafkaTemplate             : Failed to send: ProducerRecord(topic=topic, partition=null, headers=RecordHeaders(headers = [RecordHeader(key = contentType, value = [97, 112, 112, 108, 105, 99, 97, 116, 105, 111, 110, 47, 106, 115, 111, 110]), RecordHeader(key = target-protocol, value = [107, 97, 102, 107, 97]), RecordHeader(key = spring_json_header_types, value = [123, 34, 99, 111, 110, 116, 101, 110, 116, 84, 121, 112, 101, 34, 58, 34, 106, 97, 118, 97, 46, 108, 97, 110, 103, 46, 83, 116, 114, 105, 110, 103, 34, 44, 34, 116, 97, 114, 103, 101, 116, 45, 112, 114, 111, 116, 111, 99, 111, 108, 34, 58, 34, 106, 97, 118, 97, 46, 108, 97, 110, 103, 46, 83, 116, 114, 105, 110, 103, 34, 125])], isReadOnly = true), key=null, value=[B@1d1da00b, timestamp=null)

org.apache.kafka.common.errors.InvalidProducerEpochException: Producer attempted to produce with an old epoch.

2024-04-03T17:37:37.678+03:00  INFO 45784 --- [cer-tx-binder-0] o.a.k.c.p.internals.TransactionManager   : [Producer clientId=producer-tx-binder-0, transactionalId=tx-binder-0] Transiting to fatal error state due to org.apache.kafka.common.errors.ProducerFencedException: There is a newer producer with the same transactionalId which fences the current one.
2024-04-03T17:37:37.679+03:00 ERROR 45784 --- [           main] o.s.k.core.DefaultKafkaProducerFactory   : Abort failed: CloseSafeProducer [delegate=org.apache.kafka.clients.producer.KafkaProducer@3ef7fb04]

org.apache.kafka.common.errors.ProducerFencedException: There is a newer producer with the same transactionalId which fences the current one.

2024-04-03T17:37:37.680+03:00 TRACE 45784 --- [           main] o.s.k.core.DefaultKafkaProducerFactory   : CloseSafeProducer [delegate=org.apache.kafka.clients.producer.KafkaProducer@3ef7fb04] close(PT5S)
2024-04-03T17:37:37.682+03:00  WARN 45784 --- [           main] o.s.k.core.DefaultKafkaProducerFactory   : Error during some operation; producer removed from cache: CloseSafeProducer [delegate=org.apache.kafka.clients.producer.KafkaProducer@3ef7fb04]
2024-04-03T17:37:37.683+03:00  INFO 45784 --- [           main] o.a.k.clients.producer.KafkaProducer     : [Producer clientId=producer-tx-binder-0, transactionalId=tx-binder-0] Closing the Kafka producer with timeoutMillis = 5000 ms.
2024-04-03T17:37:37.688+03:00  INFO 45784 --- [           main] o.apache.kafka.common.metrics.Metrics    : Metrics scheduler closed
2024-04-03T17:37:37.689+03:00  INFO 45784 --- [           main] o.apache.kafka.common.metrics.Metrics    : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2024-04-03T17:37:37.690+03:00  INFO 45784 --- [           main] o.apache.kafka.common.metrics.Metrics    : Metrics reporters closed
2024-04-03T17:37:37.692+03:00  INFO 45784 --- [           main] o.a.kafka.common.utils.AppInfoParser     : App info kafka.producer for producer-tx-binder-0 unregistered
2024-04-03T17:37:37.694+03:00 DEBUG 45784 --- [           main] o.s.k.t.KafkaTransactionManager          : Resuming suspended transaction after completion of inner transaction
2024-04-03T17:38:29.364+03:00  WARN 45784 --- [l-1 housekeeper] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=1m10s656ms).
2024-04-03T17:38:29.370+03:00 ERROR 45784 --- [           main] o.s.t.i.TransactionInterceptor           : Application exception overridden by rollback exception

java.lang.RuntimeException: null
	at ru.test.transactional.service.PersonService.save(PersonService.java:20) ~[main/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:343) ~[spring-aop-6.0.11.jar:6.0.11]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.0.11.jar:6.0.11]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.0.11.jar:6.0.11]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:756) ~[spring-aop-6.0.11.jar:6.0.11]
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123) ~[spring-tx-6.0.11.jar:6.0.11]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:391) ~[spring-tx-6.0.11.jar:6.0.11]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119) ~[spring-tx-6.0.11.jar:6.0.11]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.0.11.jar:6.0.11]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:756) ~[spring-aop-6.0.11.jar:6.0.11]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-6.0.11.jar:6.0.11]
	at ru.test.transactional.service.PersonService$$SpringCGLIB$$0.save(<generated>) ~[main/:na]
	at ru.test.transactional.TransactionalApplication.main(TransactionalApplication.java:31) ~[main/:na]

2024-04-03T17:38:29.389+03:00  INFO 45784 --- [ionShutdownHook] o.s.i.endpoint.EventDrivenConsumer       : Removing {logging-channel-adapter:_org.springframework.integration.errorLogger} as a subscriber to the 'errorChannel' channel
2024-04-03T17:38:29.389+03:00  INFO 45784 --- [ionShutdownHook] o.s.i.channel.PublishSubscribeChannel    : Channel 'transactional.errorChannel' has 0 subscriber(s).
2024-04-03T17:38:29.390+03:00  INFO 45784 --- [ionShutdownHook] o.s.i.endpoint.EventDrivenConsumer       : stopped bean '_org.springframework.integration.errorLogger'
Exception in thread "main" org.springframework.transaction.UnexpectedRollbackException: Rollback exception, originated at (org.springframework.kafka.transaction.KafkaTransactionManager@271a140c) There is a newer producer with the same transactionalId which fences the current one.
	at org.springframework.data.transaction.ChainedTransactionManager.rollback(ChainedTransactionManager.java:218)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.completeTransactionAfterThrowing(TransactionAspectSupport.java:678)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:395)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:756)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at ru.test.transactional.service.PersonService$$SpringCGLIB$$0.save(<generated>)
	at ru.test.transactional.TransactionalApplication.main(TransactionalApplication.java:31)
Caused by: org.apache.kafka.common.errors.ProducerFencedException: There is a newer producer with the same transactionalId which fences the current one.
2024-04-03T17:38:29.393+03:00  INFO 45784 --- [ionShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2024-04-03T17:38:29.397+03:00  INFO 45784 --- [ionShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2024-04-03T17:38:29.398+03:00  INFO 45784 --- [ionShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
Disconnected from the target VM, address: '127.0.0.1:61124', transport: 'socket'

Process finished with exit code 1
